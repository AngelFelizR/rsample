<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create or Modify Stratification Variables — make_strata • rsample</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rsample</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/Basics.html">Basic Usage</a>
</li>
<li>
  <a href="../articles/Working_with_rsets.html">Working with Resample Sets</a>
</li>
<li>
  <a href="../articles/Recipes_and_rsample.html">Recipes and rsample</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create or Modify Stratification Variables</h1>
    </div>

    
    <p>For stratified resampling, this function can create strata from numeric data
  and also make non-numeric data more conducive to be used for 
  stratification.</p>
    

    <pre class="usage"><span class='fu'>make_strata</span>(<span class='no'>x</span>, <span class='kw'>nunique</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='fl'>0.15</span>, <span class='kw'>depth</span> <span class='kw'>=</span> <span class='fl'>20</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An input vector.</p></td>
    </tr>
    <tr>
      <th>nunique</th>
      <td><p>An integer for the number of unique value threshold in the 
algorithm.</p></td>
    </tr>
    <tr>
      <th>pool</th>
      <td><p>A proportion of data used to determine if a particular group is
too small and should be pooled into another group.</p></td>
    </tr>
    <tr>
      <th>depth</th>
      <td><p>An integer that is used to determine the best number of 
percentiles that should be used. The number of bins are based on 
`min(5, floor(n / depth))` where `n = length(x)`. 
If `x` is numeric, there must be at least 40 rows in the data set 
(when `depth = 20`) to conduct stratified sampling.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A factor vector.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For numeric data, if the number of unique levels is less than 
`nunique`, the data are treated as categorical data.</p>
<p>For categorical inputs, the function will find levels of `x` than
  occur in the data with percentage less than `pool`. The values from
  these groups will be randomly assigned to the remaining strata (as will
  data points that have missing values in `x`).
    For numeric data with more unique values than `nunique`, the data
  will be converted to being categorical based on percentiles of the data. 
  The percentile groups will have no more than 20 percent of the data in 
  each group. Again, missing values in `x` are randomly assigned
  to groups.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>61</span>)
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'>rpois</span>(<span class='fl'>100</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>5</span>)
<span class='fu'>table</span>(<span class='no'>x1</span>)</div><div class='output co'>#&gt; x1
#&gt;  1  2  3  4  5  6  7  8  9 10 11 
#&gt;  3 16  8 19 14 18 11  4  5  1  1 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x1</span>))</div><div class='output co'>#&gt; 
#&gt;   [1,3]   (3,4] (4,5.4] (5.4,7]  (7,11] 
#&gt;      27      19      14      29      11 </div><div class='input'>
<span class='fu'>set.seed</span>(<span class='fl'>554</span>)
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'>rpois</span>(<span class='fl'>100</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'>table</span>(<span class='no'>x2</span>)</div><div class='output co'>#&gt; x2
#&gt;  0  1  2  3  4 
#&gt; 36 34 19  6  5 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x2</span>))</div><div class='output co'>#&gt; 
#&gt;  0  1  2 
#&gt; 36 38 26 </div><div class='input'>
<span class='co'># small groups are randomly assigned</span>
<span class='no'>x3</span> <span class='kw'>&lt;-</span> <span class='fu'>factor</span>(<span class='no'>x2</span>)
<span class='fu'>table</span>(<span class='no'>x3</span>)</div><div class='output co'>#&gt; x3
#&gt;  0  1  2  3  4 
#&gt; 36 34 19  6  5 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x3</span>))</div><div class='output co'>#&gt; 
#&gt;  0  1  2 
#&gt; 41 37 22 </div><div class='input'>
<span class='co'># `oilType` data from `caret`</span>
<span class='no'>x4</span> <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='no'>LETTERS</span>[<span class='fl'>1</span>:<span class='fl'>7</span>], <span class='fu'>c</span>(<span class='fl'>37</span>, <span class='fl'>26</span>, <span class='fl'>3</span>, <span class='fl'>7</span>, <span class='fl'>11</span>, <span class='fl'>10</span>, <span class='fl'>2</span>))
<span class='fu'>table</span>(<span class='no'>x4</span>)</div><div class='output co'>#&gt; x4
#&gt;  A  B  C  D  E  F  G 
#&gt; 37 26  3  7 11 10  2 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x4</span>))</div><div class='output co'>#&gt; 
#&gt;  A  B 
#&gt; 54 42 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x4</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='fl'>0.1</span>))</div><div class='output co'>#&gt; 
#&gt;  A  B  E  F 
#&gt; 39 29 13 15 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x4</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='fl'>0.0</span>))</div><div class='output co'>#&gt; 
#&gt;  A  B  C  D  E  F  G 
#&gt; 37 26  3  7 11 10  2 </div><div class='input'>
<span class='co'># not enough data to stratify</span>
<span class='no'>x5</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fl'>20</span>)
<span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x5</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: Too little data to stratify. Unstratified resampling will be used.</span></div><div class='output co'>#&gt; 
#&gt; strata1 
#&gt;      20 </div><div class='input'>
<span class='fu'>set.seed</span>(<span class='fl'>483</span>)
<span class='no'>x6</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fl'>200</span>)
<span class='fu'>quantile</span>(<span class='no'>x6</span>, <span class='kw'>probs</span> <span class='kw'>=</span> (<span class='fl'>0</span>:<span class='fl'>5</span>)/<span class='fl'>5</span>)</div><div class='output co'>#&gt;         0%        20%        40%        60%        80%       100% 
#&gt; -2.9114060 -0.9513821 -0.3286468  0.2027140  0.7050643  2.6792505 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>make_strata</span>(<span class='no'>x6</span>))</div><div class='output co'>#&gt; 
#&gt;  [-2.91,-0.951] (-0.951,-0.329]  (-0.329,0.203]   (0.203,0.705]    (0.705,2.68] 
#&gt;              40              40              40              40              40 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Max Kuhn, <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
